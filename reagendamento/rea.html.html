<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Reagendamento" />
  <meta name="author" content="Alex Lima, Gustavo Matos, Bianca Marques" />
  <title>Reagendamento N2</title>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="img/OIP.jpg?v=2" type="image/jpeg">
  <style>
    .drag-active { border-color: #f97316 !important; background: rgba(249, 115, 22, 0.08); }
    .pill-btn.active { border-color: #fb923c !important; background: rgba(249, 115, 22, 0.2) !important; color: #fed7aa !important; }
    .os-open { color: #facc15; }
    .group-block { margin-bottom: 1.25rem; }
    .group-header { margin-bottom: .6rem; font-size: .75rem; font-weight: 900; color: #fbbf24; letter-spacing: .08em; text-transform: uppercase; }
    .list-item { display: grid; gap: .25rem; padding: .7rem; border-radius: .7rem; border: 1px solid rgba(148, 163, 184, 0.15); background: rgba(15, 23, 42, 0.45); transition: background-color .15s ease; }
    .list-item:hover { background: rgba(148, 163, 184, 0.08); }
    .client-name { font-weight: 800; }
    .client-subject { font-size: .85rem; color: #cbd5e1; }
    .os-region-block { margin-bottom: .75rem; }
    .os-region-title { margin-bottom: .35rem; font-size: .8rem; font-weight: 800; color: #67e8f9; }
    .os-item { font-size: .85rem; color: #e2e8f0; }
  </style>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100">
  <div class="mx-auto max-w-6xl px-4 py-8">
    <div class="rounded-3xl border border-white/10 bg-slate-900/70 p-4 shadow-2xl shadow-black/40 md:p-8">
      <div class="top-nav mb-6 flex items-center justify-between gap-3">
        <a class="back-link rounded-xl border border-white/10 px-4 py-2 text-sm font-semibold text-slate-200 transition hover:border-cyan-400 hover:text-cyan-300" href="../index.html">Voltar ao Painel N2</a>
        <span class="module-badge rounded-full border border-cyan-400/30 bg-cyan-500/10 px-3 py-1 text-xs font-bold uppercase tracking-wide text-cyan-300">N2 • Reagendamento</span>
      </div>

      <div class="header mb-6 flex items-center justify-center gap-4 rounded-2xl border border-white/10 bg-slate-800/70 px-4 py-4 text-center">
        <img src="img/OIP.jpg" alt="Athon" class="h-12 w-12 rounded-xl object-cover" onerror="this.style.display='none'">
        <h1 class="text-xl font-black uppercase tracking-wide md:text-2xl">Filtro de Reagendamento</h1>
      </div>

      <div id="loader" class="loader mb-3 text-center text-sm text-slate-300" aria-live="polite" hidden>Processando arquivo...</div>
      <div id="rowCount" class="row-count mb-4 text-center text-sm text-slate-400" aria-live="polite" hidden></div>

      <div id="dropzone" class="dropzone mb-6 flex min-h-44 cursor-pointer flex-col items-center justify-center gap-3 rounded-2xl border-2 border-dashed border-slate-600 bg-slate-800/40 p-5 text-center transition hover:border-orange-400 hover:bg-orange-400/10" role="button" aria-label="Enviar arquivo Excel" tabindex="0">
        <div class="icon-file text-2xl font-black tracking-widest text-orange-200">XLS</div>
        <div class="drop-text max-w-xl text-sm text-slate-300">Arraste e solte o arquivo Excel aqui ou toque para selecionar</div>
        <input type="file" id="fileInput" class="hidden" accept=".xlsx,.xls" aria-label="Arquivo Excel" />
      </div>

      <div class="filters mb-5 flex flex-wrap justify-center gap-3" role="tablist" aria-label="Regiões">
        <button class="pill-btn active rounded-full border border-orange-400 bg-orange-500/20 px-6 py-2 text-sm font-bold text-orange-200" data-target="SBC" role="tab">SBC</button>
        <button class="pill-btn rounded-full border border-slate-600 px-6 py-2 text-sm font-bold text-slate-300 transition hover:border-orange-300 hover:text-orange-200" data-target="GRAJAÚ" role="tab">GRAJAÚ</button>
        <button class="pill-btn rounded-full border border-slate-600 px-6 py-2 text-sm font-bold text-slate-300 transition hover:border-orange-300 hover:text-orange-200" data-target="FRANCO" role="tab">FRANCO</button>
      </div>

      <div class="actions-bar mb-5 flex flex-wrap items-center gap-3 rounded-2xl border border-white/10 bg-slate-800/60 p-4" id="actionsBar" hidden>
        <div class="copy-mode flex flex-wrap items-center gap-4 text-sm text-slate-300" role="toolbar" aria-label="Modo de cópia">
          <label><input type="radio" name="copyMode" value="nome" checked /> Copiar Nome</label>
          <label><input type="radio" name="copyMode" value="login" /> Copiar Login</label>
          <label><input type="radio" name="copyMode" value="id" /> Copiar ID</label>
        </div>
        <div class="ml-auto flex flex-wrap gap-2">
          <button class="action-btn rounded-xl border border-slate-500 bg-slate-700 px-3 py-2 text-sm font-bold transition hover:border-cyan-300 hover:text-cyan-200" id="btnCopyAll">Copiar Tudo</button>
          <button class="action-btn rounded-xl border border-slate-500 bg-slate-700 px-3 py-2 text-sm font-bold transition hover:border-amber-300 hover:text-amber-200" id="btnCopyIdsFree">Copiar ID</button>
          <button class="action-btn btn-reset rounded-xl border border-red-500/60 bg-red-900/40 px-3 py-2 text-sm font-bold text-red-200 transition hover:border-red-300 hover:text-red-100" id="btnReset">Limpar</button>
        </div>
      </div>

      <div id="results" class="results-area space-y-5">
        <div class="empty-msg rounded-xl border border-amber-500/40 bg-amber-500/10 px-4 py-5 text-center text-sm text-amber-200">Nenhum arquivo selecionado...</div>
      </div>

      <div id="osPanel" class="os-panel mt-6 rounded-2xl border border-cyan-400/30 bg-cyan-500/10 p-4" hidden aria-live="polite">
        <div class="os-panel-header mb-3 text-sm font-black uppercase tracking-wide text-cyan-200">Clientes com O.S. em aberto</div>
        <div id="osPanelContent" class="os-panel-content space-y-2 text-sm text-cyan-50"></div>
        <div class="mt-3 text-right">
          <button class="action-btn rounded-xl border border-cyan-400/50 bg-cyan-500/20 px-3 py-2 text-sm font-bold text-cyan-100 transition hover:bg-cyan-500/30" id="btnCopyOs">Copiar lista de O.S.</button>
        </div>
      </div>
    </div>
  </div>

  <div class="mx-auto mt-3 flex max-w-6xl flex-wrap items-center gap-4 px-4 pb-6 text-xs text-slate-300" aria-hidden="true">
    <div class="legend-row flex items-center gap-2">
      <div class="box-legend h-3 w-3 rounded-sm bg-white"></div>
      <span>Reagendamento</span>
    </div>
    <div class="legend-row flex items-center gap-2">
      <div class="box-legend h-3 w-3 rounded-sm bg-amber-400 shadow shadow-amber-300/60"></div>
      <span>Endereço não localizado</span>
    </div>
    <div class="legend-row flex items-center gap-2">
      <div class="box-legend h-3 w-3 rounded-sm bg-cyan-300 shadow shadow-cyan-300/60"></div>
      <span>Cliente com outra O.S. em aberto</span>
    </div>
  </div>

  <script src="log.js" defer></script>
</body>
</html>

